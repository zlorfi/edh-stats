<!doctype html>
<html lang="en" class="h-full bg-gray-50">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EDH Stats Tracker</title>
    <meta
      name="description"
      content="Track your Magic: The Gathering EDH/Commander games and statistics"
    />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="h-full flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8"
  >
    <div class="max-w-md w-full space-y-8 text-center" x-data="indexApp()">
      <h1 class="text-4xl font-bold font-mtg text-edh-primary mb-4">
        EDH Stats
      </h1>
      <p class="text-xl text-gray-600 mb-8">
        Track your Commander games and statistics
      </p>

      <div class="space-y-4">
        <a href="/login.html" class="btn btn-primary w-full">
          üéÆ Login to Track Games
        </a>
        <a
          x-show="allowRegistration"
          href="/register.html"
          class="btn btn-secondary w-full"
        >
          üìù Create New Account
        </a>
      </div>

      <div class="text-sm text-gray-500">
        <p>Built with Fastify, SQLite, and Alpine.js</p>
        <p>Ready to track your Commander victories!</p>
      </div>
    </div>    <script
      defer
      src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script>
      function indexApp() {
        return {
          allowRegistration: true,

          async init() {
            await this.checkRegistrationConfig()
          },

          async checkRegistrationConfig() {
            try {
              const response = await fetch('/api/auth/config')
              if (response.ok) {
                const data = await response.json()
                this.allowRegistration = data.allowRegistration
              } else {
                // Default to true if endpoint fails
                this.allowRegistration = true
              }
            } catch (error) {
              console.error('Failed to check registration config:', error)
              // Default to true if request fails
              this.allowRegistration = true
            }
          }
        }
      }

      document.addEventListener('alpine:init', () => {
        Alpine.data('indexApp', indexApp)
      })
    </script>


  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-8 mt-12">
    <div class="container mx-auto px-4 text-center">
      <p class="text-gray-400">
        EDH Stats Tracker - Track your Commander games with style
      </p>
      <p class="text-gray-500 text-sm mt-2">
        Built with Fastify, SQLite, and Alpine.js
      </p>
      <p class="text-gray-600 text-xs mt-3" id="version-footer">
        <!-- Version loaded dynamically -->
      </p>
    </div>
  </footer>

  <script>
    // Load and display version in footer
    (async function loadVersion() {
      try {
        const response = await fetch('/version.txt');
        if (response.ok) {
          const version = await response.text();
          const versionEl = document.getElementById('version-footer');
          if (versionEl) {
            versionEl.textContent = `v${version.trim()}`;
          }
        }
      } catch (error) {
        console.debug('Version file not available');
      }
    })();
  </script>
  </body>
</html>
